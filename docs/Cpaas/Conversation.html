<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Cpaas::Conversation
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Cpaas::Conversation";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span>
     &raquo; 
    <span class="title">Conversation</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Cpaas::Conversation
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Cpaas::Conversation</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/cpaas/resources/conversation.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>CPaaS conversation.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_message-class_method" title="create_message (class method)">.<strong>create_message</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Send a new outbound message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_message-class_method" title="delete_message (class method)">.<strong>delete_message</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete conversation message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_messages-class_method" title="get_messages (class method)">.<strong>get_messages</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets all messages.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_messages_in_thread-class_method" title="get_messages_in_thread (class method)">.<strong>get_messages_in_thread</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read all messages in a thread.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_status-class_method" title="get_status (class method)">.<strong>get_status</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read a conversation message status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_subscription-class_method" title="get_subscription (class method)">.<strong>get_subscription</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read active subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_subscriptions-class_method" title="get_subscriptions (class method)">.<strong>get_subscriptions</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Read all active subscriptions.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subscribe-class_method" title="subscribe (class method)">.<strong>subscribe</strong>(params)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unsubscribe-class_method" title="unsubscribe (class method)">.<strong>unsubscribe</strong>(params = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Unsubscription from conversation notification.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create_message-class_method">
  
    .<strong>create_message</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Send a new outbound message</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:sender_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Sender address information, basically the from address. E164 formatted DID
number passed as a value, which is owned by the user. If the user wants to
let CPaaS uses the default assigned DID number, this field can either has
“default” value or the same value as the userId.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:destination_address</span>
          <span class="type">(<tt>Array[string]|String</tt>)</span>
          <span class="default">
            
          </span>
          
        </li>
      
        <li>
          <span class="name">:message</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>text message</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 18</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create_message'>create_message</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:destination_address</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>String</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:destination_address</span><span class='rbracket'>]</span> <span class='rbracket'>]</span> <span class='op'>:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:destination_address</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>body:</span> <span class='lbrace'>{</span>
        <span class='label'>outboundSMSMessageRequest:</span> <span class='lbrace'>{</span>
          <span class='label'>address:</span> <span class='id identifier rubyid_address'>address</span><span class='comma'>,</span>
          <span class='label'>clientCorrelator:</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_client_correlator'>client_correlator</span><span class='comma'>,</span>
          <span class='label'>outboundSMSTextMessage:</span> <span class='lbrace'>{</span>
            <span class='label'>message:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:message</span><span class='rbracket'>]</span>
          <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>
      <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/outbound/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:sender_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/requests</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='symbol'>:post</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_process_response'><span class='object_link'><a href="../top-level-namespace.html#process_response-instance_method" title="#process_response (method)">process_response</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>
      <span class='id identifier rubyid_outboundSMS'>outboundSMS</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:outbound_sms_message_request</span><span class='rparen'>)</span>

      <span class='lbrace'>{</span>
        <span class='label'>message:</span> <span class='id identifier rubyid_outboundSMS'>outboundSMS</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:outbound_sms_text_message</span><span class='comma'>,</span> <span class='symbol'>:message</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>senderAddress:</span> <span class='id identifier rubyid_outboundSMS'>outboundSMS</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:sender_address</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>deliveryInfo:</span> <span class='id identifier rubyid_outboundSMS'>outboundSMS</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:delivery_info_list</span><span class='comma'>,</span> <span class='symbol'>:delivery_info</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_message-class_method">
  
    .<strong>delete_message</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete conversation message</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:remote_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Remote address information while retrieving the conversation history,
basically the destination telephone number that user exchanged message
before. E164 formatted DID number passed as a value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:local_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Local address information while retrieving the conversation history,
basically the source telephone number that user exchanged message before.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:message_id</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> Identification of the message. If messeageId is not
passsed then the conversation thread is deleted with all messages.</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100
101
102
103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 97</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_delete_message'>delete_message</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/remoteAddresses/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:remote_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/localAddresses/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:local_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='id identifier rubyid_url'>url</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/messages/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:message_id</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:message_id</span><span class='rbracket'>]</span>

    <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='symbol'>:delete</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_messages-class_method">
  
    .<strong>get_messages</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets all messages.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:remote_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> Remote address information while retrieving the
conversation history, basically the destination telephone number that user
exchanged message before. E164 formatted DID number passed as a value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:local_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> Local address information while retrieving the
conversation history, basically the source telephone number that user
exchanged message before.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:name]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Performs search operation on firstName and lastName
fields.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:first_name]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Performs search for the first_name field of the
directory items.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:last_name]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Performs search for the last_name field of the
directory items.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:user_name]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Performs search for the user_name field of the
directory items.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:phone_number]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Performs search for the fields containing a phone
number, like businessPhoneNumber, homePhoneNumber, mobile, pager, fax.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:order]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Ordering the contact results based on the requested
sortBy value, order query parameter should be accompanied by sortBy query
parameter.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:sort_by]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - sort_by value is used to detect sorting the contact
results based on which attribute. If order is not provided with that,
ascending order is used.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:max]</span>
          <span class="type">(<tt>Number</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Maximum number of contact results that has been
requested from CPaaS for this query.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:next]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Pointer for the next chunk of contacts, should be
gathered from the previous query results.</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 64</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_messages'>get_messages</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>query:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:query</span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/remoteAddresses</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_url'>url</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:remote_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:remote_address</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_url'>url</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/localAddresses/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:local_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:local_address</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_process_response'><span class='object_link'><a href="../top-level-namespace.html#process_response-instance_method" title="#process_response (method)">process_response</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:local_address</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:sms_thread_list</span><span class='comma'>,</span> <span class='symbol'>:sms_thread</span><span class='rparen'>)</span>
          <span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_reject'><span class='object_link'><a href="../top-level-namespace.html#reject-instance_method" title="#reject (method)">reject</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_l'>l</span><span class='comma'>,</span> <span class='symbol'>:resource_url</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:sms_thread</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_reject'><span class='object_link'><a href="../top-level-namespace.html#reject-instance_method" title="#reject (method)">reject</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='symbol'>:resource_url</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_messages_in_thread-class_method">
  
    .<strong>get_messages_in_thread</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Read all messages in a thread</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:remote_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Remote address information while retrieving the conversation history,
basically the destination telephone number that user exchanged message
before. E164 formatted DID number passed as a value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:local_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Local address information while retrieving the conversation history,
basically the source telephone number that user exchanged message before.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:next]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Pointer for the next page to retrieve for the
messages, provided by CPaaS in previous GET response.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:max]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Number of messages that is requested from CPaaS.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:new]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Filters the messages or threads having messages
that are not received by the user yet.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:query[:last_Message_Time]</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> - Filters the messages or threads having messages
that are sent/received after provided Epoch time</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


119
120
121
122
123
124
125
126
127
128
129
130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 119</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_messages_in_thread'>get_messages_in_thread</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>query:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:query</span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/remoteAddresses/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:remote_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/localAddresses/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:local_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/messages</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_process_response'><span class='object_link'><a href="../top-level-namespace.html#process_response-instance_method" title="#process_response (method)">process_response</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:sms_message_list</span><span class='comma'>,</span> <span class='symbol'>:sms_message</span><span class='rparen'>)</span>
      <span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span> <span class='id identifier rubyid_reject'><span class='object_link'><a href="../top-level-namespace.html#reject-instance_method" title="#reject (method)">reject</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='symbol'>:resource_url</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_status-class_method">
  
    .<strong>get_status</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Read a conversation message status</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:remote_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Remote address information while retrieving the conversation history,
basically the destination telephone number that user exchanged message
before. E164 formatted DID number passed as a value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:local_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Local address information while retrieving the conversation history,
basically the source telephone number that user exchanged message before.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:message_id</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Identification of the message. If messeageId is not passsed then the
conversation thread is deleted with all messages.</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145
146
147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 143</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_status'>get_status</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/remoteAddresses/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:remote_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/localAddresses/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:local_address</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/messages/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:message_id</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/status</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_subscription-class_method">
  
    .<strong>get_subscription</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Read active subscription</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:subscription_id</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Resource ID of the subscription</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 179</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_subscription'>get_subscription</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/inbound/subscriptions/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:subscription_id</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_process_response'><span class='object_link'><a href="../top-level-namespace.html#process_response-instance_method" title="#process_response (method)">process_response</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>
      <span class='id identifier rubyid_subscription'>subscription</span> <span class='op'>=</span> <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:subscription</span><span class='rparen'>)</span>

      <span class='lbrace'>{</span>
        <span class='label'>notify_url:</span> <span class='id identifier rubyid_subscription'>subscription</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:callback_reference</span><span class='comma'>,</span> <span class='symbol'>:notify_url</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>destination_address:</span> <span class='id identifier rubyid_subscription'>subscription</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:destination_address</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>subscription_id:</span> <span class='id identifier rubyid_id_from'><span class='object_link'><a href="../top-level-namespace.html#id_from-instance_method" title="#id_from (method)">id_from</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subscription'>subscription</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:resource_url</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_subscriptions-class_method">
  
    .<strong>get_subscriptions</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Read all active subscriptions</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 155</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_subscriptions'>get_subscriptions</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/inbound/subscriptions</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_process_response'><span class='object_link'><a href="../top-level-namespace.html#process_response-instance_method" title="#process_response (method)">process_response</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>
      <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:subscription_list</span><span class='comma'>,</span> <span class='symbol'>:subscription</span><span class='rparen'>)</span>
        <span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subscriptions'>subscriptions</span><span class='op'>|</span>
          <span class='lbrace'>{</span>
            <span class='label'>notify_url:</span> <span class='id identifier rubyid_subscription'>subscription</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:callback_reference</span><span class='comma'>,</span> <span class='symbol'>:notify_url</span><span class='rparen'>)</span><span class='comma'>,</span>
            <span class='label'>destination_address:</span> <span class='id identifier rubyid_subscription'>subscription</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:destination_address</span><span class='rparen'>)</span><span class='comma'>,</span>
            <span class='label'>subscription_id:</span> <span class='id identifier rubyid_id_from'><span class='object_link'><a href="../top-level-namespace.html#id_from-instance_method" title="#id_from (method)">id_from</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subscription'>subscription</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:resource_url</span><span class='rparen'>)</span><span class='rparen'>)</span>
          <span class='rbrace'>}</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subscribe-class_method">
  
    .<strong>subscribe</strong>(params)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a new subscription</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:type</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Type of conversation. Possible values - &#39;sms&#39;. Check
Conversation.types for more options</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:webhook_url</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The notification channel ID that has been acquired during
/notificationchannel API subscription, either websockets, mobile push or
webhooks type, which the incoming notifications supposed to be sent to.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:destination_address</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p><code>optional</code> The address that incoming messages are received for
this subscription. If does not exist, CPaaS uses the default assigned DID
number to subscribe against. It is suggested to provide the intended E164
formatted DID number within this parameter.</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 204</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_subscribe'>subscribe</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_channel'>channel</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='op'>::</span><span class='const'>NotificationChannel</span><span class='period'>.</span><span class='id identifier rubyid_create_channel'>create_channel</span><span class='lparen'>(</span><span class='label'>webhook_url:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:webhook_url</span><span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_channel'>channel</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_channel'>channel</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:exception_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>body:</span> <span class='lbrace'>{</span>
        <span class='label'>subscription:</span> <span class='lbrace'>{</span>
          <span class='label'>callbackReference:</span> <span class='lbrace'>{</span>
            <span class='label'>notifyURL:</span> <span class='id identifier rubyid_channel'>channel</span><span class='lbracket'>[</span><span class='symbol'>:channel_id</span><span class='rbracket'>]</span>
          <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='label'>clientCorrelator:</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_client_correlator'>client_correlator</span><span class='comma'>,</span>
          <span class='label'>destinationAddress:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:destination_address</span><span class='rbracket'>]</span>
        <span class='rbrace'>}</span>
      <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/inbound/subscriptions</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='symbol'>:post</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_process_response'><span class='object_link'><a href="../top-level-namespace.html#process_response-instance_method" title="#process_response (method)">process_response</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>
      <span class='lbrace'>{</span>
        <span class='label'>webhook_url:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:webhook_url</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='label'>destination_address:</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:subscription</span><span class='comma'>,</span> <span class='symbol'>:destination_address</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='label'>subscription_id:</span> <span class='id identifier rubyid_id_from'><span class='object_link'><a href="../top-level-namespace.html#id_from-instance_method" title="#id_from (method)">id_from</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='symbol'>:subscription</span><span class='comma'>,</span> <span class='symbol'>:resource_url</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unsubscribe-class_method">
  
    .<strong>unsubscribe</strong>(params = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Unsubscription from conversation notification</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:subscription_id</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Resource ID of the subscription.</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


241
242
243
244
245
246
247
248
249
250
251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/cpaas/resources/conversation.rb', line 241</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_unsubscribe'>unsubscribe</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='symbol'>:SMS</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Cpaas.html" title="Cpaas (module)">Cpaas</a></span></span><span class='period'>.</span><span class='id identifier rubyid_api'><span class='object_link'><a href="../Cpaas.html#api-class_method" title="Cpaas.api (method)">api</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send_request'>send_request</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_base_url'>base_url</span><span class='embexpr_end'>}</span><span class='tstring_content'>/inbound/subscriptions/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:subscription_id</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='symbol'>:delete</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_process_response'><span class='object_link'><a href="../top-level-namespace.html#process_response-instance_method" title="#process_response (method)">process_response</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>
      <span class='lbrace'>{</span>
        <span class='label'>subscription_id:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:subscription_id</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='label'>success:</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='label'>message:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unsubscribed from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> conversation notification</span><span class='tstring_end'>&quot;</span></span>
      <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Oct 16 11:36:36 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.5.0).
</div>

    </div>
  </body>
</html>